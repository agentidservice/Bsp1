<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Agentic Solutions ‚Äì Agent Demos</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --page-bg: #0a0b0d;
      --page-text: #ffffff;
      --glass-border: rgba(255, 255, 255, 0.12);
      --shadow-strong: 0 25px 60px rgba(0, 0, 0, 0.6);
      --text: #ffffff;
      --text-muted: rgba(255, 255, 255, 0.55);
      --gap: 20px;
      --radius-lg: 24px;
      --radius-md: 16px;
      --radius-sm: 12px;
      --chat-width: min(380px, 90vw);
      --chat-height: min(580px, 75vh);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      background: var(--page-bg);
      color: var(--page-text);
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
    }

    /* Agentic Solutions Header */
    .agentic-header {
      position: fixed;
      top: 0;
      right: 0;
      left: 0;
      padding: 16px 24px;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      z-index: 100;
      background: linear-gradient(180deg, rgba(10, 11, 13, 0.98) 0%, rgba(10, 11, 13, 0.8) 70%, transparent 100%);
      pointer-events: none;
    }

    .agentic-badge {
      pointer-events: auto;
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 20px;
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 14px;
      transition: all 0.2s ease;
    }

    .agentic-badge:hover {
      background: rgba(255, 255, 255, 0.06);
      border-color: rgba(255, 255, 255, 0.12);
    }

    .agentic-badge-icon {
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
    }

    .agentic-badge-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .agentic-badge-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
    }

    .agentic-badge-subtitle {
      font-size: 11px;
      color: var(--text-muted);
    }

    /* Main Content */
    .wrap {
      max-width: 900px;
      margin: 0 auto;
      padding: 100px 24px 180px;
    }

    .page-title {
      margin: 0 0 8px;
      font-size: clamp(28px, 4vw, 42px);
      font-weight: 600;
      letter-spacing: -0.025em;
    }

    .page-subtitle {
      margin: 0 0 60px;
      color: var(--text-muted);
      font-size: 15px;
      line-height: 1.6;
      max-width: 50ch;
    }

    /* Demo Cards */
    .demo-card {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 20px;
      padding: 28px 32px;
      margin-bottom: 24px;
      transition: all 0.2s ease;
    }

    .demo-card:hover {
      background: rgba(255, 255, 255, 0.035);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .demo-card-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 10px;
    }

    .demo-card-icon {
      width: 52px;
      height: 52px;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
    }

    .demo-card-icon.handwerk {
      background: linear-gradient(135deg, rgba(217, 119, 6, 0.2) 0%, rgba(245, 158, 11, 0.1) 100%);
      border: 1px solid rgba(217, 119, 6, 0.3);
    }

    .demo-card-icon.friseur {
      background: linear-gradient(135deg, rgba(37, 99, 235, 0.2) 0%, rgba(59, 130, 246, 0.1) 100%);
      border: 1px solid rgba(37, 99, 235, 0.3);
    }

    .demo-card-title {
      font-size: 20px;
      font-weight: 600;
      margin: 0;
    }

    .demo-card-desc {
      color: var(--text-muted);
      font-size: 14px;
      line-height: 1.5;
      margin: 0;
    }

    .demo-card-hint {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 16px;
      padding: 8px 14px;
      background: rgba(255, 255, 255, 0.04);
      border-radius: 8px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .demo-card-hint svg {
      width: 14px;
      height: 14px;
      stroke: currentColor;
    }

    /* SHARED CHAT STYLES */
    .chat-widget {
      position: fixed;
      z-index: 9999;
    }

    .chat-toggle {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow-strong);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .chat-toggle:hover {
      transform: scale(1.05);
    }

    .chat-window {
      position: absolute;
      bottom: 72px;
      width: var(--chat-width);
      height: var(--chat-height);
      max-height: calc(100vh - 100px);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-strong);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      display: none;
      flex-direction: column;
    }

    .chat-window.is-open {
      display: flex;
    }

    .chat-window::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.2) 50%, transparent 100%);
      z-index: 10;
    }

    .chat-body {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
    }

    .chat-messages {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: auto;
    }

    .chat-message {
      max-width: 85%;
      padding: 12px 16px;
      border-radius: var(--radius-md);
      font-size: 14px;
      line-height: 1.5;
      white-space: pre-line;
    }

    .chat-message.bot {
      align-self: flex-start;
      border-bottom-left-radius: 6px;
    }

    .chat-message.user {
      align-self: flex-end;
      color: #fff;
      border-bottom-right-radius: 6px;
    }

    .chat-input-area {
      padding: 14px 16px;
      border-top: 1px solid var(--glass-border);
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .chat-input-area input {
      flex: 1;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-sm);
      padding: 12px 16px;
      font-size: 14px;
      color: var(--text);
      outline: none;
      font-family: inherit;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    .chat-input-area input::placeholder {
      color: var(--text-muted);
    }

    .chat-send-btn {
      width: 44px;
      height: 44px;
      border: none;
      border-radius: var(--radius-sm);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.15s ease;
    }

    .chat-send-btn:hover {
      transform: translateY(-1px);
    }

    .chat-send-btn svg {
      width: 18px;
      height: 18px;
      fill: #fff;
    }

    .chat-back {
      position: absolute;
      top: 16px;
      left: 16px;
      width: 36px;
      height: 36px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.04);
      backdrop-filter: blur(8px);
      color: var(--text-muted);
      cursor: pointer;
      display: none;
      place-items: center;
      z-index: 60;
      transition: all 0.2s ease;
    }

    .chat-back.is-visible {
      display: grid;
    }

    .chat-back:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text);
    }

    .chat-back svg {
      width: 18px;
      height: 18px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
    }

    .chat-menu {
      position: absolute;
      inset: 0;
      padding: 32px 24px 24px;
      display: none;
      flex-direction: column;
      z-index: 50;
    }

    .chat-menu.is-open {
      display: flex;
    }

    .chat-welcome {
      margin-bottom: 8px;
    }

    .chat-welcome-title {
      font-family: 'Playfair Display', serif;
      font-size: 26px;
      font-weight: 600;
      color: var(--text);
      margin: 0 0 6px 0;
      letter-spacing: -0.02em;
    }

    .chat-welcome-subtitle {
      font-size: 13px;
      color: var(--text-muted);
      line-height: 1.5;
      margin: 0;
    }

    .chat-stripe {
      display: flex;
      gap: 4px;
      margin: 20px 0 24px 0;
    }

    .chat-stripe span {
      height: 3px;
      border-radius: 2px;
      flex: 1;
    }

    .chat-options {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
      justify-content: center;
    }

    .chat-option {
      width: 100%;
      background: rgba(255, 255, 255, 0.04);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: var(--radius-md);
      padding: 16px 18px;
      text-align: left;
      font-size: 14px;
      font-weight: 500;
      color: var(--text);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 14px;
      transition: all 0.2s ease;
    }

    .chat-option:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
    }

    .chat-option-icon {
      font-size: 20px;
      width: 42px;
      height: 42px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.06);
      border-radius: 11px;
      flex-shrink: 0;
    }

    .chat-option-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .chat-option-label {
      font-weight: 500;
    }

    .chat-option-desc {
      font-size: 11px;
      font-weight: 400;
      color: var(--text-muted);
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .chat-menu.is-open .chat-welcome,
    .chat-menu.is-open .chat-stripe,
    .chat-menu.is-open .chat-options {
      animation: fadeIn 0.3s ease forwards;
    }

    .chat-menu.is-open .chat-stripe { animation-delay: 0.05s; }
    .chat-menu.is-open .chat-options { animation-delay: 0.1s; }

    /* HANDWERK THEME (Orange) */
    #handwerk-widget {
      right: var(--gap);
      bottom: 100px;
    }

    #handwerk-widget .chat-toggle {
      background: linear-gradient(135deg, #1a1816 0%, #252220 100%);
    }

    #handwerk-widget .chat-window {
      right: 0;
      background: rgba(22, 20, 16, 0.92);
    }

    #handwerk-widget .chat-message.bot {
      background: rgba(50, 44, 38, 0.75);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    #handwerk-widget .chat-message.user {
      background: linear-gradient(135deg, #d97706 0%, #f59e0b 100%);
      box-shadow: 0 4px 20px rgba(217, 119, 6, 0.3);
    }

    #handwerk-widget .chat-input-area {
      background: rgba(0, 0, 0, 0.3);
    }

    #handwerk-widget .chat-input-area input:focus {
      border-color: #d97706;
      box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.3);
    }

    #handwerk-widget .chat-send-btn {
      background: linear-gradient(135deg, #d97706 0%, #f59e0b 100%);
      box-shadow: 0 4px 12px rgba(217, 119, 6, 0.3);
    }

    #handwerk-widget .chat-stripe span:nth-child(1) { background: #d97706; }
    #handwerk-widget .chat-stripe span:nth-child(2) { background: #78716c; }
    #handwerk-widget .chat-stripe span:nth-child(3) { background: #f59e0b; }

    #handwerk-widget .chat-menu {
      background: linear-gradient(180deg, rgba(22, 20, 16, 0.98) 0%, rgba(22, 20, 16, 0.9) 100%);
    }

    /* FRISEUR THEME (Blue) */
    #friseur-widget {
      right: var(--gap);
      bottom: var(--gap);
    }

    #friseur-widget .chat-toggle {
      background: linear-gradient(135deg, #12141a 0%, #1e2028 100%);
    }

    #friseur-widget .chat-window {
      right: 0;
      background: rgba(18, 20, 26, 0.92);
    }

    #friseur-widget .chat-message.bot {
      background: rgba(40, 44, 52, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    #friseur-widget .chat-message.user {
      background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
      box-shadow: 0 4px 20px rgba(37, 99, 235, 0.3);
    }

    #friseur-widget .chat-input-area {
      background: rgba(0, 0, 0, 0.3);
    }

    #friseur-widget .chat-input-area input:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.3);
    }

    #friseur-widget .chat-send-btn {
      background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }

    #friseur-widget .chat-stripe span:nth-child(1) { background: #2563eb; }
    #friseur-widget .chat-stripe span:nth-child(2) { background: rgba(255,255,255,0.8); }
    #friseur-widget .chat-stripe span:nth-child(3) { background: #dc2626; }

    #friseur-widget .chat-menu {
      background: linear-gradient(180deg, rgba(18, 20, 26, 0.98) 0%, rgba(18, 20, 26, 0.9) 100%);
    }

    /* Mobile */
    @media (max-width: 768px) {
      .agentic-header { padding: 12px 16px; }
      .agentic-badge { padding: 10px 14px; }
      .agentic-badge-icon { width: 32px; height: 32px; font-size: 16px; }
      .wrap { padding: 90px 16px 200px; }
      .demo-card { padding: 20px; }
      #handwerk-widget { bottom: 88px; }
      .chat-window {
        width: calc(100vw - 32px);
        height: calc(100vh - 160px);
        right: -10px;
      }
      #friseur-widget .chat-window {
        height: calc(100vh - 100px);
      }
    }

    .typing-indicator {
      display: flex;
      gap: 4px;
      padding: 12px 16px;
      align-self: flex-start;
    }

    .typing-indicator span {
      width: 8px;
      height: 8px;
      background: rgba(255, 255, 255, 0.4);
      border-radius: 50%;
      animation: typing 1.4s infinite ease-in-out;
    }

    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
      30% { transform: translateY(-4px); opacity: 1; }
    }
  </style>
</head>

<body>
  <!-- Header -->
  <header class="agentic-header">
    <div class="agentic-badge">
      <div class="agentic-badge-icon">‚ö°</div>
      <div class="agentic-badge-text">
        <span class="agentic-badge-title">Agentic Solutions</span>
        <span class="agentic-badge-subtitle">Demo-Agents Showcase</span>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="wrap">
    <h1 class="page-title">KI-Assistenten in Aktion</h1>
    <p class="page-subtitle">Erlebe unsere intelligenten Chatbots live. Klicke auf einen der Buttons unten rechts, um einen Demo-Agenten zu testen.</p>

    <div class="demo-card">
      <div class="demo-card-header">
        <div class="demo-card-icon handwerk">üõ†Ô∏è</div>
        <div>
          <h2 class="demo-card-title">Projektbau GG Handwerk GmbH</h2>
          <p class="demo-card-desc">Ihr Partner f√ºr Maler-, Metall-, Regal- und Ger√ºstbau. Infos und Auftragsanfragen rund um die Uhr.</p>
        </div>
      </div>
      <div class="demo-card-hint">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M12 19V5M5 12l7-7 7 7"/></svg>
        Chat √∂ffnen mit dem üõ†Ô∏è Button
      </div>
    </div>

    <div class="demo-card">
      <div class="demo-card-header">
        <div class="demo-card-icon friseur">üíà</div>
        <div>
          <h2 class="demo-card-title">Conar Friseur</h2>
          <p class="demo-card-desc">Termine buchen, √§ndern oder stornieren ‚Äì direkt im Chat mit Jason oder Elina.</p>
        </div>
      </div>
      <div class="demo-card-hint">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M12 19V5M5 12l7-7 7 7"/></svg>
        Chat √∂ffnen mit dem üíà Button
      </div>
    </div>
  </div>

  <!-- HANDWERK WIDGET -->
  <div id="handwerk-widget" class="chat-widget">
    <div class="chat-toggle" id="handwerk-toggle">üõ†Ô∏è</div>
    <div class="chat-window" id="handwerk-window">
      <div class="chat-back" id="handwerk-back">
        <svg viewBox="0 0 24 24"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
      </div>
      <div class="chat-menu is-open" id="handwerk-menu">
        <div class="chat-welcome">
          <h2 class="chat-welcome-title">Projektbau GG Handwerk GmbH üõ†Ô∏è</h2>
          <p class="chat-welcome-subtitle">Professionelle Handwerksleistungen.<br>Wie k√∂nnen wir Ihnen helfen?</p>
        </div>
        <div class="chat-stripe"><span></span><span></span><span></span></div>
        <div class="chat-options" id="handwerk-options">
          <div class="chat-option" data-mode="maler">
            <span class="chat-option-icon">üé®</span>
            <span class="chat-option-text">
              <span class="chat-option-label">Malerbetrieb</span>
              <span class="chat-option-desc">Innen- & Au√üenanstriche, Tapezieren</span>
            </span>
          </div>
          <div class="chat-option" data-mode="metall">
            <span class="chat-option-icon">üî©</span>
            <span class="chat-option-text">
              <span class="chat-option-label">Metallbau</span>
              <span class="chat-option-desc">Gel√§nder, Z√§une, Konstruktionen</span>
            </span>
          </div>
          <div class="chat-option" data-mode="regal">
            <span class="chat-option-icon">üì¶</span>
            <span class="chat-option-text">
              <span class="chat-option-label">Regalbau</span>
              <span class="chat-option-desc">Lager- & Industrieregale</span>
            </span>
          </div>
          <div class="chat-option" data-mode="geruest">
            <span class="chat-option-icon">üèóÔ∏è</span>
            <span class="chat-option-text">
              <span class="chat-option-label">Ger√ºstbau</span>
              <span class="chat-option-desc">Auf- & Abbau, Verleih</span>
            </span>
          </div>
        </div>
      </div>
      <div class="chat-body" id="handwerk-body" style="display: none;">
        <div class="chat-messages" id="handwerk-messages"></div>
      </div>
      <div class="chat-input-area" id="handwerk-input" style="display: none;">
        <input type="text" id="handwerk-field" placeholder="Nachricht schreiben‚Ä¶">
        <button class="chat-send-btn" id="handwerk-send">
          <svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
        </button>
      </div>
    </div>
  </div>

  <!-- FRISEUR WIDGET -->
  <div id="friseur-widget" class="chat-widget">
    <div class="chat-toggle" id="friseur-toggle">üíà</div>
    <div class="chat-window" id="friseur-window">
      <div class="chat-back" id="friseur-back">
        <svg viewBox="0 0 24 24"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
      </div>
      <div class="chat-menu is-open" id="friseur-menu">
        <div class="chat-welcome">
          <h2 class="chat-welcome-title">Willkommen bei Conar üíà</h2>
          <p class="chat-welcome-subtitle">Dein Barber in der Nachbarschaft.<br>Wie k√∂nnen wir dir helfen?</p>
        </div>
        <div class="chat-stripe"><span></span><span></span><span></span></div>
        <div class="chat-options" id="friseur-options">
          <div class="chat-option" data-mode="info">
            <span class="chat-option-icon">‚ÑπÔ∏è</span>
            <span class="chat-option-text">
              <span class="chat-option-label">Infos zum Salon</span>
              <span class="chat-option-desc">√ñffnungszeiten, Preise & mehr</span>
            </span>
          </div>
          <div class="chat-option" data-mode="jason">
            <span class="chat-option-icon">‚úÇÔ∏è</span>
            <span class="chat-option-text">
              <span class="chat-option-label">Termin bei Jason</span>
              <span class="chat-option-desc">Jetzt einen Slot reservieren</span>
            </span>
          </div>
          <div class="chat-option" data-mode="elina">
            <span class="chat-option-icon">‚úÇÔ∏è</span>
            <span class="chat-option-text">
              <span class="chat-option-label">Termin bei Elina</span>
              <span class="chat-option-desc">Jetzt einen Slot reservieren</span>
            </span>
          </div>
        </div>
      </div>
      <div class="chat-body" id="friseur-body" style="display: none;">
        <div class="chat-messages" id="friseur-messages"></div>
      </div>
      <div class="chat-input-area" id="friseur-input" style="display: none;">
        <input type="text" id="friseur-field" placeholder="Nachricht schreiben‚Ä¶">
        <button class="chat-send-btn" id="friseur-send">
          <svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
        </button>
      </div>
    </div>
  </div>

  <script>
    // =====================================================================
    // HANDWERK CHATBOT - Vollst√§ndig isoliert
    // =====================================================================
    (function() {
      const WEBHOOK = "https://seidel1502.app.n8n.cloud/webhook/a6a426be-f177-400f-a96c-77d1482f181d";
      
      const MESSAGES = {
        maler: "üé® Willkommen beim Malerbetrieb!\n\nIch helfe Ihnen gerne bei:\n‚Ä¢ Informationen zu unseren Leistungen\n‚Ä¢ Auftragsanfragen f√ºr Ihr Projekt\n\nWie kann ich Ihnen behilflich sein?",
        metall: "üî© Willkommen beim Metallbau!\n\nIch helfe Ihnen gerne bei:\n‚Ä¢ Informationen zu unseren Leistungen\n‚Ä¢ Auftragsanfragen f√ºr Ihr Projekt\n\nWie kann ich Ihnen behilflich sein?",
        regal: "üì¶ Willkommen beim Regalbau!\n\nIch helfe Ihnen gerne bei:\n‚Ä¢ Informationen zu unseren Leistungen\n‚Ä¢ Auftragsanfragen f√ºr Ihr Projekt\n\nWie kann ich Ihnen behilflich sein?",
        geruest: "üèóÔ∏è Willkommen beim Ger√ºstbau!\n\nIch helfe Ihnen gerne bei:\n‚Ä¢ Informationen zu unseren Leistungen\n‚Ä¢ Auftragsanfragen f√ºr Ihr Projekt\n\nWie kann ich Ihnen behilflich sein?"
      };

      let mode = null;
      let history = [];

      const $ = id => document.getElementById(id);

      // Toggle
      $('handwerk-toggle').addEventListener('click', () => {
        $('handwerk-window').classList.toggle('is-open');
        $('friseur-window').classList.remove('is-open');
      });

      // Back
      $('handwerk-back').addEventListener('click', () => {
        mode = null;
        history = [];
        $('handwerk-menu').classList.add('is-open');
        $('handwerk-body').style.display = 'none';
        $('handwerk-input').style.display = 'none';
        $('handwerk-back').classList.remove('is-visible');
        $('handwerk-messages').innerHTML = '';
      });

      // Options
      $('handwerk-options').addEventListener('click', (e) => {
        const option = e.target.closest('.chat-option');
        if (!option) return;
        
        mode = option.dataset.mode;
        history = [];
        
        $('handwerk-menu').classList.remove('is-open');
        $('handwerk-body').style.display = 'flex';
        $('handwerk-input').style.display = 'flex';
        $('handwerk-back').classList.add('is-visible');
        $('handwerk-messages').innerHTML = '';
        
        addMsg(MESSAGES[mode], 'bot');
        
        setTimeout(() => {
          $('handwerk-body').scrollTop = $('handwerk-body').scrollHeight;
        }, 50);
      });

      // Send
      $('handwerk-send').addEventListener('click', send);
      $('handwerk-field').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') send();
      });

      function addMsg(text, type) {
        const msg = document.createElement('div');
        msg.className = `chat-message ${type}`;
        msg.textContent = text;
        $('handwerk-messages').appendChild(msg);
        $('handwerk-body').scrollTop = $('handwerk-body').scrollHeight;
      }

      function showTyping() {
        const t = document.createElement('div');
        t.className = 'typing-indicator';
        t.id = 'handwerk-typing';
        t.innerHTML = '<span></span><span></span><span></span>';
        $('handwerk-messages').appendChild(t);
        $('handwerk-body').scrollTop = $('handwerk-body').scrollHeight;
      }

      function hideTyping() {
        const t = $('handwerk-typing');
        if (t) t.remove();
      }

      async function send() {
        const text = $('handwerk-field').value.trim();
        if (!text) return;

        $('handwerk-field').value = '';
        addMsg(text, 'user');
        history.push({ role: 'user', content: text });

        showTyping();

        try {
          const res = await fetch(WEBHOOK, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
              chatInput: text,
              mode: mode,
              history: history,
              source: 'handwerk'
            })
          });

          const data = await res.json();
          hideTyping();

          const reply = clean(data.reply || data.output || data.text || data.message || JSON.stringify(data));
          addMsg(reply, 'bot');
          history.push({ role: 'assistant', content: reply });
        } catch (err) {
          hideTyping();
          addMsg('Entschuldigung, es gab einen Fehler. Bitte versuchen Sie es erneut.', 'bot');
        }
      }

      function clean(text) {
        if (typeof text !== 'string') return String(text);
        let c = text.trim();
        if (c.startsWith('{') && c.endsWith('}')) {
          try {
            const p = JSON.parse(c);
            c = p.reply || p.output || p.text || p.message || c;
          } catch (e) {}
        }
        return c.replace(/^["‚Äû"']+|["‚Äû"']+$/g, '').trim();
      }
    })();


    // =====================================================================
    // FRISEUR CHATBOT - Vollst√§ndig isoliert
    // =====================================================================
    (function() {
      const WEBHOOK = "https://seidel1502.app.n8n.cloud/webhook/conar-chat";
      
      const MESSAGES = {
        info: "‚ÑπÔ∏è Hi! Ich gebe dir folgende Infos zu Conar Friseur üòä\n‚Ä¢ √ñffnungszeiten\n‚Ä¢ Leistungen & Haarschnitte\n‚Ä¢ Unsere Friseure\n‚Ä¢ Terminbuchung",
        jason: "‚úÇÔ∏è Hi, ich bin Jason üòä\nFang gerne mit deinem gew√ºnschten Datum an!ü§ó",
        elina: "‚úÇÔ∏è Hi, ich bin Elina üòä\nFang gerne mit deinem gew√ºnschten Datum an!ü§ó"
      };

      let mode = null;
      let history = [];

      const $ = id => document.getElementById(id);

      // Toggle
      $('friseur-toggle').addEventListener('click', () => {
        $('friseur-window').classList.toggle('is-open');
        $('handwerk-window').classList.remove('is-open');
      });

      // Back
      $('friseur-back').addEventListener('click', () => {
        mode = null;
        history = [];
        $('friseur-menu').classList.add('is-open');
        $('friseur-body').style.display = 'none';
        $('friseur-input').style.display = 'none';
        $('friseur-back').classList.remove('is-visible');
        $('friseur-messages').innerHTML = '';
      });

      // Options
      $('friseur-options').addEventListener('click', (e) => {
        const option = e.target.closest('.chat-option');
        if (!option) return;
        
        mode = option.dataset.mode;
        history = [];
        
        $('friseur-menu').classList.remove('is-open');
        $('friseur-body').style.display = 'flex';
        $('friseur-input').style.display = 'flex';
        $('friseur-back').classList.add('is-visible');
        $('friseur-messages').innerHTML = '';
        
        addMsg(MESSAGES[mode], 'bot');
        
        setTimeout(() => {
          $('friseur-body').scrollTop = $('friseur-body').scrollHeight;
        }, 50);
      });

      // Send
      $('friseur-send').addEventListener('click', send);
      $('friseur-field').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') send();
      });

      function addMsg(text, type) {
        const msg = document.createElement('div');
        msg.className = `chat-message ${type}`;
        msg.textContent = text;
        $('friseur-messages').appendChild(msg);
        $('friseur-body').scrollTop = $('friseur-body').scrollHeight;
      }

      function showTyping() {
        const t = document.createElement('div');
        t.className = 'typing-indicator';
        t.id = 'friseur-typing';
        t.innerHTML = '<span></span><span></span><span></span>';
        $('friseur-messages').appendChild(t);
        $('friseur-body').scrollTop = $('friseur-body').scrollHeight;
      }

      function hideTyping() {
        const t = $('friseur-typing');
        if (t) t.remove();
      }

      async function send() {
        const text = $('friseur-field').value.trim();
        if (!text) return;

        $('friseur-field').value = '';
        addMsg(text, 'user');
        history.push({ role: 'user', content: text });

        showTyping();

        try {
          const res = await fetch(`${WEBHOOK}?mode=${mode}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
              chatInput: text,
              mode: mode,
              history: history,
              source: 'friseur'
            })
          });

          const data = await res.json();
          hideTyping();

          const reply = clean(data.reply || data.output || data.text || data.message || JSON.stringify(data));
          addMsg(reply, 'bot');
          history.push({ role: 'assistant', content: reply });
        } catch (err) {
          hideTyping();
          addMsg('Entschuldigung, es gab einen Fehler. Bitte versuche es erneut.', 'bot');
        }
      }

      function clean(text) {
        if (typeof text !== 'string') return String(text);
        let c = text.trim();
        if (c.startsWith('{') && c.endsWith('}')) {
          try {
            const p = JSON.parse(c);
            c = p.reply || p.output || p.text || p.message || c;
          } catch (e) {}
        }
        return c.replace(/^["‚Äû"']+|["‚Äû"']+$/g, '').trim();
      }
    })();
  </script>
</body>
</html>
